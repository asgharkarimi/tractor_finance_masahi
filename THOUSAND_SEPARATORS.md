# جداکننده هزارگان (Thousand Separators)

## تغییرات اعمال شده

### 1. ایجاد کلاس کمکی برای فرمت‌دهی اعداد
- فایل جدید: `lib/utils/number_formatter.dart`
- کلاس `ThousandsSeparatorInputFormatter` برای فرمت خودکار اعداد هنگام تایپ
- پشتیبانی از ویرایش در وسط متن و حفظ موقعیت کرسر

### 2. فیلدهای ورودی با جداکننده هزارگان

#### صفحه تنظیمات (Settings Screen)
- فیلد "قیمت کشت هر هکتار" با فرمت خودکار
- مثال: `1,300,000` تومان

#### صفحه جزئیات کشاورز (Farmer Detail Screen)
- دیالوگ "افزودن پرداخت" با فیلد مبلغ فرمت‌شده
- مثال: `100,000` تومان

### 3. نمایش اعداد با جداکننده هزارگان

تمام صفحات زیر از `NumberFormat('#,###')` استفاده می‌کنند:

#### صفحه اصلی (Home Screen)
- نمایش باقیمانده بدهی هر کشاورز

#### صفحه جزئیات کشاورز (Farmer Detail Screen)
- کارت‌های آماری: بدهی، پرداختی، باقیمانده
- هزینه هر زمین
- مبلغ هر پرداخت

#### صفحه گزارش (Report Screen)
- خلاصه گزارش: مجموع درآمد، درآمد وصول شده، درآمد وصول نشده
- جزئیات هر کشاورز

#### گزارش PDF (PDF Service)
- تمام مبالغ در فایل PDF با جداکننده هزارگان
- استفاده از فونت Vazir برای نمایش صحیح اعداد فارسی

## نحوه استفاده

### برای فیلدهای ورودی:
```dart
TextField(
  controller: amountController,
  keyboardType: TextInputType.number,
  inputFormatters: [ThousandsSeparatorInputFormatter()],
  decoration: const InputDecoration(
    labelText: 'مبلغ (تومان)',
    hintText: '100,000',
  ),
)
```

### برای نمایش اعداد:
```dart
final numberFormat = NumberFormat('#,###');
Text('${numberFormat.format(amount)} تومان')
```

### برای دریافت مقدار عددی از فیلد ورودی:
```dart
final amount = double.tryParse(controller.text.replaceAll(',', ''));
```

## ویژگی‌ها
- ✅ فرمت خودکار هنگام تایپ
- ✅ حفظ موقعیت کرسر هنگام ویرایش
- ✅ پشتیبانی از ویرایش در وسط متن
- ✅ حذف خودکار کاراکترهای غیرعددی
- ✅ نمایش یکپارچه در تمام صفحات
- ✅ سازگاری با گزارش PDF
- ✅ استفاده از فونت فارسی در PDF برای نمایش صحیح اعداد

## رفع مشکل نمایش اعداد در PDF
مشکل نمایش اعداد به صورت مربع‌های خالی (□□□) در PDF با اضافه کردن فونت Vazir حل شد:
- بارگذاری فونت از assets با fallback به فونت سیستم
- استفاده از `pw.MultiPage` برای پشتیبانی بهتر از محتوای طولانی
- استفاده از `Printing.sharePdf` برای اشتراک‌گذاری مستقیم فایل
- تبدیل اعداد به int برای جلوگیری از خطاهای فرمت
- پشتیبانی کامل از اعداد و حروف فارسی
